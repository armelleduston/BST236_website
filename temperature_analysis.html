<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Station Data Visualization</title>
    <link href="https://fonts.googleapis.com/css2?family=Helvetica&family=Georgia&display=swap" rel="stylesheet">
    <style>
        /* General Styles */
        body {
            background-color: #1e1e1e;
            color: #ecf6eb;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        header {
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            align-items: center;
            height: auto;
            padding: 20px 0;
        }

        h1 {
            color: #dd67cb;
            margin: 20px 0;
            font-size: 2em;
            text-align: center;
            font-family: 'Helvetica', serif;
        }

        header p {
            color: #e4b05c;
            font-size: 1.2em;
            margin-top: 20px;
            font-family: 'Helvetica', serif;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            text-align: left;
            background-color: #292929;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 70vh;
            overflow-x: auto;
            padding: 20px 0;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 1.2em;
            color: #666;
        }

        .error {
            color: #d32f2f;
            padding: 20px;
            text-align: center;
            background-color: #ffebee;
            border-radius: 4px;
            margin: 20px 0;
        }

        .plotly-graph-div {
            background-color: #292929 !important;
        }

        /* Scrollable Chart */
        .chart-container {
            overflow-x: auto;
            max-width: 100%;
        }

        nav a {
            background-color: #1cbd54;
            padding: 10px 20px;
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            font-size: 1.1em;
            margin-top: 20px;
        }

        nav a:hover {
            background-color: #54b1c6;
        }
    </style>
</head>

<body>
    <header>
        <p>Visualizing Distribution of Temperatures per Station</p>
    </header>

    <div class="container">
        <div id="loadingIndicator" class="loading">Loading data...</div>
        <div id="errorContainer" class="error" style="display: none;"></div>
        <div class="chart-container">
            <div id="temperatureChart"></div>
        </div>
    </div>

    <!-- Plotly.js library -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <script>
        const loadingIndicator = document.getElementById('loadingIndicator');
        const errorContainer = document.getElementById('errorContainer');

        // Fetch the data from the JSON file
        fetch('temperature_data.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Error fetching data');
                }
                return response.json();
            })
            .then(data => {
                loadingIndicator.style.display = 'none';  // Hide loading message as data is now loaded

                // Prepare the data for Plotly box plot (one boxplot per station)
                const stations = data.map(station => station.station);  // Get station names
                const minTemps = data.map(station => parseFloat(station.min_temp)); // Min temperature values
                const medians = data.map(station => parseFloat(station.median)); // Median temperature values
                const maxTemps = data.map(station => parseFloat(station.max_temp)); // Max temperature values
                const stdDevs = data.map(station => parseFloat(station.std)); // Standard deviation values

                // Data for boxplots, grouping min_temp, median, max_temp for each station
                const plotData = stations.map((station, i) => ({
                    type: 'box',
                    y: [minTemps[i], medians[i], maxTemps[i]],
                    name: station,
                    boxmean: 'sd',  // Optionally add the standard deviation as a marker
                    marker: { color: 'rgb(54, 162, 235)' },  // Color the boxes
                    jitter: 0.05,
                    whiskerwidth: 2,  // Make whiskers more visible
                    line: {
                        width: 2
                    },
                    boxpoints: 'all',  // Show individual points inside the boxplot
                    pointpos: 0  // Position of points relative to box (0 places them inside)
                }));

                // Create the layout for the plot
                const layout = {
                    title: 'Temperature Distribution per Station',
                    xaxis: {
                        title: 'Station',
                        tickvals: stations,  // Use station names as x-axis values
                        ticktext: stations,  // Display station names on x-axis
                        tickangle: 45,
                        tickmode: 'array', // This ensures we control tick placement
                        ticklen: 10, // Length of ticks (can be adjusted)
                        showgrid: false,
                        showline: true,
                        zeroline: false,
                        tickangle: 45, // Rotate x-axis labels
                        tickspacing: 1, // Ensure spacing between ticks
                        tickfont: {
                            size: 12,  // Adjust font size for station names
                            color: '#ecf6eb'  // Font color for station names
                        }
                    },
                    yaxis: {
                        title: 'Temperature (Â°C)',
                        zeroline: false,
                        titlefont: {
                            size: 14,
                            color: '#ecf6eb'
                        },
                        tickfont: {
                            size: 12,
                            color: '#ecf6eb'
                        }
                    },
                    showlegend: false,  // No legend needed as it's a single trace per station
                    boxmode: 'group',  // Group box plots by station
                    height: 600,  // Set a fixed height for the plot
                    margin: {
                        b: 150, // Add space at the bottom for x-axis labels
                        t: 50,  // Adjust the top margin
                        l: 50,  // Adjust left margin
                        r: 50   // Adjust right margin
                    },
                    hovermode: 'closest',  // Ensure that hover works well
                    plot_bgcolor: '#292929',  // Set background color for the plot area
                    paper_bgcolor: '#292929', // Set background color for the whole chart
                    font: {
                        color: '#ecf6eb',  // Text color for axis labels and title
                        family: 'Arial, sans-serif'
                    },
                    bargap: 0.3,  // Adjust the gap between the boxplots
                    bargroupgap: 0.1  // Ensure a gap between the groups
                };

                // Create the box plot
                Plotly.newPlot('temperatureChart', plotData, layout);
            })
            .catch(error => {
                loadingIndicator.style.display = 'none';  // Hide loading indicator
                errorContainer.textContent = 'Error loading the data: ' + error.message;
                errorContainer.style.display = 'block';
            });
    </script>

    <nav>
        <a href="index.html">Back to Homepage</a>
    </nav>
</body>

</html>